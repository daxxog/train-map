/* TrainMap
 * high level database for Ticket to Ride
 * (c) 2015 David (daXXog) Volm ><> + + + <><
 * Released under Apache License, Version 2.0:
 * http://www.apache.org/licenses/LICENSE-2.0.html  
 */ !function(t,i){"object"==typeof exports?module.exports=i():"function"==typeof define&&define.amd?define(i):t.TrainMap=i()}(this,function(){var t,i=require("train-route"),n=require("train-destination");return t=function(){this.routes=[],this.destinations={},this.clean()},t.prototype.clean=function(){return this.smart={destination:{name:{by:{id:{}}}}},this},t.prototype.build=function(){var t;this.clean();for(t in this.destinations)this.smart.destination.name.by.id[this.destinations[t]._id]=t;return this},t.prototype.destination=function(t,i){return"undefined"==typeof this.destinations[t]&&(this.destinations[t]=new n(t)),i!==!0&&this.build(),this},t.prototype.route=function(t,n,e,s){return this.destination(t,!0).destination(n,!0).routes.push(new i(this.destinations[t],this.destinations[n],e)),s!==!0&&this.build(),this},t.prototype["import"]=function(t){var i=this;return t.forEach(function(t){i.route(t.a,t.b,t.cars,!0)}),this.build(),this},t.prototype["export"]=function(){var t=this.smart.destination.name.by.id;return this.routes.map(function(i){return{a:t[i.a],b:t[i.b],cars:i.cars}})},t});